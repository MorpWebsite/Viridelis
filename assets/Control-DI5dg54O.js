import{c as T,r as i,g as J,h as ie,j as e,i as oe,P as X,k as ce,l as le,m as _,u as de,L as H,a as ue,B as I,A as me,C as z,b as K,d as F,e as G,f as O}from"./index-TdliDF3m.js";import{r as M,o as V,e as he,R as pe,T as fe,a as xe,b as U,H as q,c as Z,d as R,s as B,p as ge}from"./tabs-BBUu3Ohd.js";const be=T("Fan",[["path",{d:"M10.827 16.379a6.082 6.082 0 0 1-8.618-7.002l5.412 1.45a6.082 6.082 0 0 1 7.002-8.618l-1.45 5.412a6.082 6.082 0 0 1 8.618 7.002l-5.412-1.45a6.082 6.082 0 0 1-7.002 8.618l1.45-5.412Z",key:"484a7f"}],["path",{d:"M12 12v.01",key:"u5ubse"}]]);const ke=T("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);const ve=T("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);const je=T("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]);const W=T("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);const ye=T("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function we(a){const t=i.useRef({value:a,previous:a});return i.useMemo(()=>(t.current.value!==a&&(t.current.previous=t.current.value,t.current.value=a),t.current.previous),[a])}var D="Switch",[Ne]=oe(D),[Ce,Se]=Ne(D),Q=i.forwardRef((a,t)=>{const{__scopeSwitch:l,name:x,checked:p,defaultChecked:N,required:g,disabled:b,value:j="on",onCheckedChange:L,form:f,...k}=a,[C,y]=i.useState(null),$=J(t,S=>y(S)),w=i.useRef(!1),A=C?f||!!C.closest("form"):!0,[v,P]=ie({prop:p,defaultProp:N??!1,onChange:L,caller:D});return e.jsxs(Ce,{scope:l,checked:v,disabled:b,children:[e.jsx(X.button,{type:"button",role:"switch","aria-checked":v,"aria-required":g,"data-state":te(v),"data-disabled":b?"":void 0,disabled:b,value:j,...k,ref:$,onClick:ce(a.onClick,S=>{P(E=>!E),A&&(w.current=S.isPropagationStopped(),w.current||S.stopPropagation())})}),A&&e.jsx(se,{control:C,bubbles:!w.current,name:x,value:j,checked:v,required:g,disabled:b,form:f,style:{transform:"translateX(-100%)"}})]})});Q.displayName=D;var Y="SwitchThumb",ee=i.forwardRef((a,t)=>{const{__scopeSwitch:l,...x}=a,p=Se(Y,l);return e.jsx(X.span,{"data-state":te(p.checked),"data-disabled":p.disabled?"":void 0,...x,ref:t})});ee.displayName=Y;var Me="SwitchBubbleInput",se=i.forwardRef(({__scopeSwitch:a,control:t,checked:l,bubbles:x=!0,...p},N)=>{const g=i.useRef(null),b=J(g,N),j=we(l),L=le(t);return i.useEffect(()=>{const f=g.current;if(!f)return;const k=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(k,"checked").set;if(j!==l&&y){const $=new Event("click",{bubbles:x});y.call(f,l),f.dispatchEvent($)}},[j,l,x]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:l,...p,tabIndex:-1,ref:b,style:{...p.style,...L,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});se.displayName=Me;function te(a){return a?"checked":"unchecked"}var ae=Q,Re=ee;const ne=i.forwardRef(({className:a,...t},l)=>e.jsx(ae,{className:_("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...t,ref:l,children:e.jsx(Re,{className:_("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));ne.displayName=ae.displayName;const Ae=()=>{const{toast:a}=de(),[t,l]=i.useState(!1),[x,p]=i.useState(!1),[N,g]=i.useState(0),[b,j]=i.useState("Belum Terhubung"),[L,f]=i.useState(!1),[k,C]=i.useState({fans:Array(4).fill(!1),growLights:Array(8).fill(!1),pumps:Array(12).fill(!1),mainLights:Array(8).fill(!1)}),[y,$]=i.useState([]);i.useEffect(()=>{const s=M(R,"controlHistory"),r=V(s,o=>{const n=o.val();if(n){const d=Object.values(n).slice(-20);$(d)}});return()=>{r()}},[]);const w=async()=>{const s=Date.now();try{const r=M(R,"devices"),n=(await new Promise((c,u)=>{const m=V(r,h=>{m(),c(h)},h=>{m(),u(h)})})).val();if(n){const c=(u,m)=>{if(!u)return Array(m).fill(!1);const h=Object.values(u);return h.length===m?h:Array(m).fill(!1).map((Te,re)=>h[re]??!1)};C({fans:c(n.fans,4),growLights:c(n.growlights,8),pumps:c(n.pumps,12),mainLights:c(n.mainlights,8)})}const d=Date.now()-s;g(d),l(!0),j(new Date().toLocaleString("id-ID")),await B(M(R,"connection"),{status:"connected",lastResponseTime:d})}catch(r){console.error("Connection error:",r),l(!1),await B(M(R,"connection"),{status:"disconnected",lastResponseTime:0})}};i.useEffect(()=>{w();const s=setInterval(()=>{w()},1e4);return()=>clearInterval(s)},[]);const A=async()=>{p(!0),await w(),a({title:t?"Koneksi Berhasil":"Koneksi Gagal",description:t?"Terhubung kembali ke Firebase & Arduino":"Tidak dapat terhubung ke Firebase",variant:t?"default":"destructive"}),p(!1)},v={fans:{name:"Kipas Ventilasi",icon:be,gradient:"from-cyan-500/20 to-blue-500/20",description:"Mengatur sirkulasi udara dalam greenhouse"},growLights:{name:"Lampu Grow Light",icon:ke,gradient:"from-yellow-500/20 to-orange-500/20",description:"Memberikan cahaya tambahan untuk tanaman"},pumps:{name:"Pompa Air",icon:je,gradient:"from-green-500/20 to-emerald-500/20",description:"Mengatur sistem irigasi otomatis"},mainLights:{name:"Lampu Utama",icon:ye,gradient:"from-purple-500/20 to-pink-500/20",description:"Penerangan utama dalam ruangan greenhouse"}},P=async(s,r)=>{const o={...k},n=!o[s][r];o[s][r]=n;const d=Date.now();try{await B(M(R,`devices/${s}`),o[s]);const c=Date.now()-d;g(c),await S(s,r,n);const u=`${v[s].name} ${r+1}`;a({title:"Perangkat Diperbarui",description:`${u} telah ${n?"diaktifkan":"dinonaktifkan"}`})}catch{a({title:"Error",description:"Gagal memperbarui perangkat",variant:"destructive"})}},S=async(s,r,o)=>{try{const n=M(R,"controlHistory"),d=`${v[s].name} ${r+1}`;await ge(n,{timestamp:Date.now(),device:d,action:o?"Aktifkan":"Nonaktifkan",state:o})}catch(n){console.error("Error saving history:",n)}},E=()=>{if(!("webkitSpeechRecognition"in window)){a({title:"Browser Tidak Didukung",description:"Gunakan Google Chrome untuk kontrol suara.",variant:"destructive"});return}const s=new window.webkitSpeechRecognition;s.lang="id-ID",s.continuous=!1,s.interimResults=!1,s.onstart=()=>{f(!0),a({title:"ðŸŽ™ï¸ Mendengarkan...",description:"Ucapkan: aktifkan kipas 1, matikan pompa 2, nyalakan lampu utama 3, dst."})},s.onresult=r=>{const o=r.results[0][0].transcript.toLowerCase();f(!1);const n={kipas:"fans","grow light":"growLights",pompa:"pumps","lampu utama":"mainLights"};for(const[d,c]of Object.entries(n))if(o.includes(d)){const u=o.match(/\d+/);if(u){const m=parseInt(u[0])-1;if(m>=0&&m<k[c].length){const h=!(o.includes("mati")||o.includes("nonaktif"));k[c][m]!==h?(P(c,m),a({title:"Perintah Suara",description:`Berhasil ${h?"mengaktifkan":"menonaktifkan"} ${d} ${m+1}`})):a({title:"Tidak Ada Perubahan",description:`${d} ${m+1} sudah dalam keadaan ${h?"aktif":"nonaktif"}`})}}}},s.onerror=()=>{f(!1),a({title:"Gagal Mendeteksi Suara",description:"Coba ulangi perintah lagi.",variant:"destructive"})},s.start()};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("nav",{className:"container mx-auto px-4 py-6 border-b border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(H,{to:"/",className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-8 h-8 text-primary"}),e.jsx("span",{className:"text-2xl font-bold glow-text",children:"Viridelis"})]}),e.jsx(H,{to:"/menu",children:e.jsxs(I,{variant:"ghost",className:"text-foreground hover:text-primary",children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),"Kembali ke Menu"]})})]})}),e.jsxs("main",{className:"container mx-auto px-4 py-12",children:[e.jsxs("div",{className:"text-center mt-4 mb-4",children:[e.jsx("h1",{className:"text-5xl font-bold mb-4",children:"Kontrol Jarak Jauh"}),e.jsx("p",{className:"text-muted-foreground text-lg mt-4 mb-8",children:"Kendalikan perangkat greenhouse Anda secara realtime"})]}),e.jsxs("div",{className:"flex justify-center items-center gap-2 mb-4",children:[e.jsxs("div",{className:"glass-card px-4 py-2 rounded-full flex items-center gap-2",children:[e.jsx(W,{className:`w-4 h-4 ${t?"text-green-500 animate-pulse":"text-red-500"}`}),e.jsx("span",{className:`font-semibold ${t?"text-green-500":"text-red-500"}`,children:t?"Connected":"Disconnected"})]}),e.jsxs("div",{className:"glass-card px-4 py-2 rounded-full flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4 text-primary"}),e.jsxs("span",{className:"text-sm",children:["Response: ",t?`${N} ms`:"Not Connected"]})]}),e.jsxs(I,{onClick:A,disabled:x,variant:"outline",size:"sm",className:"glass-card",children:[e.jsx(pe,{className:`w-4 h-4 mr-2 ${x?"animate-spin":""}`}),"Reconnect"]}),e.jsx(I,{size:"icon",onClick:E,className:`rounded-full glass-card relative ${L?"bg-primary/20 text-primary animate-pulse ring-2 ring-primary/40":"text-foreground"}`,children:e.jsx(ve,{className:"w-5 h-5"})})]}),e.jsxs(fe,{defaultValue:"control",children:[e.jsxs(xe,{className:"grid w-full max-w-md mx-auto grid-cols-2",children:[e.jsx(U,{value:"control",children:"Kontrol"}),e.jsxs(U,{value:"history",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Riwayat"]})]}),e.jsx(Z,{value:"control",children:e.jsx("div",{className:"space-y-8",children:Object.entries(v).map(([s,r])=>{const o=s,n=k[o],d=n.filter(Boolean).length;return e.jsxs(z,{className:"glass-card",children:[e.jsx(K,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs(F,{className:"flex items-center gap-2 text-2xl mb-2",children:[e.jsx("div",{className:`bg-gradient-to-br ${r.gradient} p-2 rounded-lg`,children:e.jsx(r.icon,{className:"w-6 h-6"})}),r.name]}),e.jsx(G,{children:r.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),e.jsxs("p",{className:"text-lg font-bold text-primary",children:[d,"/",n.length," Aktif"]})]})]})}),e.jsx(O,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:n.map((c,u)=>e.jsxs("div",{className:`glass-card p-4 rounded-lg transition-all ${c?"border-primary/50 shadow-[0_0_15px_rgba(74,222,128,0.2)]":"border-border/50"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-semibold text-sm",children:["#",u+1]}),e.jsx(ne,{checked:c,onCheckedChange:()=>P(o,u),className:"data-[state=checked]:bg-primary"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:c?"Aktif":"Nonaktif"})]},u))})})]},s)})})}),e.jsx(Z,{value:"history",children:e.jsxs(z,{className:"glass-card",children:[e.jsxs(K,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5"}),"Riwayat Kontrol"]}),e.jsx(G,{children:"20 aktivitas terakhir"})]}),e.jsx(O,{children:e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:y.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Belum ada riwayat kontrol"}):y.slice().reverse().map((s,r)=>e.jsxs("div",{className:"glass-card p-4 rounded-lg flex justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.device}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(s.timestamp).toLocaleString("id-ID")})]}),e.jsx("span",{className:`font-semibold ${s.state?"text-primary":"text-muted-foreground"}`,children:s.action})]},r))})})]})})]})]}),e.jsx("footer",{className:"border-t border-border bg-background/60 backdrop-blur-md",children:e.jsxs("div",{className:"container mx-auto px-4 py-6 flex flex-col md:flex-row justify-between items-center text-sm text-muted-foreground gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:`w-4 h-4 ${t?"text-green-500 animate-pulse":"text-red-500"}`}),e.jsxs("span",{children:["Firebase:"," ",e.jsx("strong",{className:t?"text-green-500":"text-red-500",children:t?"Connected":"Disconnected"})]})]}),e.jsxs("div",{children:["Response Time:"," ",e.jsx("strong",{className:"text-primary",children:t?`${N} ms`:"N/A"})]}),e.jsxs("div",{children:["Last Connected:"," ",e.jsx("strong",{className:"text-foreground",children:b})]})]})})]})};export{Ae as default};
