import{c as R,r as i,g as J,h as ce,j as e,i as le,P as X,k as de,l as ue,m as _,u as me,L as H,a as he,B as E,A as pe,C as z,b as K,d as F,e as O,f as G}from"./index-BaX9q6RM.js";import{r as S,o as V,e as fe,R as xe,T as ge,a as be,b as U,H as q,c as Z,d as M,s as B,p as ke}from"./tabs-DAbR0jmZ.js";const ve=R("Fan",[["path",{d:"M10.827 16.379a6.082 6.082 0 0 1-8.618-7.002l5.412 1.45a6.082 6.082 0 0 1 7.002-8.618l-1.45 5.412a6.082 6.082 0 0 1 8.618 7.002l-5.412-1.45a6.082 6.082 0 0 1-7.002 8.618l1.45-5.412Z",key:"484a7f"}],["path",{d:"M12 12v.01",key:"u5ubse"}]]);const je=R("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);const ye=R("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);const we=R("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]);const W=R("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);const Ne=R("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function Ce(a){const s=i.useRef({value:a,previous:a});return i.useMemo(()=>(s.current.value!==a&&(s.current.previous=s.current.value,s.current.value=a),s.current.previous),[a])}var D="Switch",[Se]=le(D),[Me,Re]=Se(D),Q=i.forwardRef((a,s)=>{const{__scopeSwitch:l,name:x,checked:p,defaultChecked:w,required:b,disabled:k,value:y="on",onCheckedChange:L,form:f,...T}=a,[N,g]=i.useState(null),$=J(s,j=>g(j)),C=i.useRef(!1),A=N?f||!!N.closest("form"):!0,[v,I]=ce({prop:p,defaultProp:w??!1,onChange:L,caller:D});return e.jsxs(Me,{scope:l,checked:v,disabled:k,children:[e.jsx(X.button,{type:"button",role:"switch","aria-checked":v,"aria-required":b,"data-state":se(v),"data-disabled":k?"":void 0,disabled:k,value:y,...T,ref:$,onClick:de(a.onClick,j=>{I(P=>!P),A&&(C.current=j.isPropagationStopped(),C.current||j.stopPropagation())})}),A&&e.jsx(te,{control:N,bubbles:!C.current,name:x,value:y,checked:v,required:b,disabled:k,form:f,style:{transform:"translateX(-100%)"}})]})});Q.displayName=D;var Y="SwitchThumb",ee=i.forwardRef((a,s)=>{const{__scopeSwitch:l,...x}=a,p=Re(Y,l);return e.jsx(X.span,{"data-state":se(p.checked),"data-disabled":p.disabled?"":void 0,...x,ref:s})});ee.displayName=Y;var Le="SwitchBubbleInput",te=i.forwardRef(({__scopeSwitch:a,control:s,checked:l,bubbles:x=!0,...p},w)=>{const b=i.useRef(null),k=J(b,w),y=Ce(l),L=ue(s);return i.useEffect(()=>{const f=b.current;if(!f)return;const T=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(T,"checked").set;if(y!==l&&g){const $=new Event("click",{bubbles:x});g.call(f,l),f.dispatchEvent($)}},[y,l,x]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:l,...p,tabIndex:-1,ref:k,style:{...p.style,...L,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});te.displayName=Le;function se(a){return a?"checked":"unchecked"}var ae=Q,Te=ee;const ne=i.forwardRef(({className:a,...s},l)=>e.jsx(ae,{className:_("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...s,ref:l,children:e.jsx(Te,{className:_("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));ne.displayName=ae.displayName;const De=()=>{const{toast:a}=me(),[s,l]=i.useState(!1),[x,p]=i.useState(!1),[w,b]=i.useState(0),[k,y]=i.useState("Belum Terhubung"),[L,f]=i.useState(!1),[T,N]=i.useState(!0),[g,$]=i.useState({fans:Array(4).fill(!1),growLights:Array(8).fill(!1),pumps:Array(12).fill(!1),mainLights:Array(8).fill(!1)}),[C,A]=i.useState([]);i.useEffect(()=>{const t=S(M,"controlHistory"),n=V(t,o=>{const r=o.val();if(r){const d=Object.values(r).slice(-20);A(d)}});return()=>{n()}},[]);const v=async()=>{const t=Date.now();try{const n=S(M,"devices"),r=(await new Promise((c,u)=>{const m=V(n,h=>{m(),c(h)},h=>{m(),u(h)})})).val();if(r){const c=(u,m)=>{if(!u)return Array(m).fill(!1);const h=Object.values(u);return h.length===m?h:Array(m).fill(!1).map(($e,oe)=>h[oe]??!1)};$({fans:c(r.fans,4),growLights:c(r.growlights,8),pumps:c(r.pumps,12),mainLights:c(r.mainlights,8)})}const d=Date.now()-t;b(d),l(!0),y(new Date().toLocaleString("id-ID")),await B(S(M,"connection"),{status:"connected",lastResponseTime:d})}catch(n){console.error("Connection error:",n),l(!1),await B(S(M,"connection"),{status:"disconnected",lastResponseTime:0})}};i.useEffect(()=>{let t=!1;(async()=>{await v(),t||N(!1)})();const o=setInterval(()=>{v()},1e4);return()=>{t=!0,clearInterval(o)}},[]);const I=async()=>{p(!0),await v(),a({title:s?"Koneksi Berhasil":"Koneksi Gagal",description:s?"Terhubung kembali ke Firebase & Arduino":"Tidak dapat terhubung ke Firebase",variant:s?"default":"destructive"}),p(!1)},j={fans:{name:"Kipas Ventilasi",icon:ve,gradient:"from-cyan-500/20 to-blue-500/20",description:"Mengatur sirkulasi udara dalam greenhouse"},growLights:{name:"Lampu Grow Light",icon:je,gradient:"from-yellow-500/20 to-orange-500/20",description:"Memberikan cahaya tambahan untuk tanaman"},pumps:{name:"Pompa Air",icon:we,gradient:"from-green-500/20 to-emerald-500/20",description:"Mengatur sistem irigasi otomatis"},mainLights:{name:"Lampu Utama",icon:Ne,gradient:"from-purple-500/20 to-pink-500/20",description:"Penerangan utama dalam ruangan greenhouse"}},P=async(t,n)=>{const o={...g},r=!o[t][n];o[t][n]=r;const d=Date.now();try{await B(S(M,`devices/${t}`),o[t]);const c=Date.now()-d;b(c),await re(t,n,r);const u=`${j[t].name} ${n+1}`;a({title:"Perangkat Diperbarui",description:`${u} telah ${r?"diaktifkan":"dinonaktifkan"}`})}catch{a({title:"Error",description:"Gagal memperbarui perangkat",variant:"destructive"})}},re=async(t,n,o)=>{try{const r=S(M,"controlHistory"),d=`${j[t].name} ${n+1}`;await ke(r,{timestamp:Date.now(),device:d,action:o?"Aktifkan":"Nonaktifkan",state:o})}catch(r){console.error("Error saving history:",r)}},ie=()=>{if(!("webkitSpeechRecognition"in window)){a({title:"Browser Tidak Didukung",description:"Gunakan Google Chrome untuk kontrol suara.",variant:"destructive"});return}const t=new window.webkitSpeechRecognition;t.lang="id-ID",t.continuous=!1,t.interimResults=!1,t.onstart=()=>{f(!0),a({title:"ðŸŽ™ï¸ Mendengarkan...",description:"Ucapkan: aktifkan kipas 1, matikan pompa 2, nyalakan lampu utama 3, dst."})},t.onresult=n=>{const o=n.results[0][0].transcript.toLowerCase();f(!1);const r={kipas:"fans","grow light":"growLights",pompa:"pumps","lampu utama":"mainLights"};for(const[d,c]of Object.entries(r))if(o.includes(d)){const u=o.match(/\d+/);if(u){const m=parseInt(u[0])-1;if(m>=0&&m<g[c].length){const h=!(o.includes("mati")||o.includes("nonaktif"));g[c][m]!==h?(P(c,m),a({title:"Perintah Suara",description:`Berhasil ${h?"mengaktifkan":"menonaktifkan"} ${d} ${m+1}`})):a({title:"Tidak Ada Perubahan",description:`${d} ${m+1} sudah dalam keadaan ${h?"aktif":"nonaktif"}`})}}}},t.onerror=()=>{f(!1),a({title:"Gagal Mendeteksi Suara",description:"Coba ulangi perintah lagi.",variant:"destructive"})},t.start()};return T?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-semibold",children:"Memuat data kontrol..."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sedang mencoba terhubung ke Firebase. Mohon tunggu."})]})}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("nav",{className:"container mx-auto px-4 py-6 border-b border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(H,{to:"/",className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-8 h-8 text-primary"}),e.jsx("span",{className:"text-2xl font-bold glow-text",children:"Viridelis"})]}),e.jsx(H,{to:"/menu",children:e.jsxs(E,{variant:"ghost",className:"text-foreground hover:text-primary",children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Kembali ke Menu"]})})]})}),e.jsxs("main",{className:"container mx-auto px-4 py-12",children:[e.jsxs("div",{className:"text-center mt-4 mb-4",children:[e.jsx("h1",{className:"text-5xl font-bold mb-4",children:"Kontrol Jarak Jauh"}),e.jsx("p",{className:"text-muted-foreground text-lg mt-4 mb-8",children:"Kendalikan perangkat greenhouse Anda secara realtime"})]}),e.jsxs("div",{className:"flex justify-center items-center gap-2 mb-4",children:[e.jsxs("div",{className:"glass-card px-4 py-2 rounded-full flex items-center gap-2",children:[e.jsx(W,{className:`w-4 h-4 ${s?"text-green-500 animate-pulse":"text-red-500"}`}),e.jsx("span",{className:`font-semibold ${s?"text-green-500":"text-red-500"}`,children:s?"Connected":"Disconnected"})]}),e.jsxs("div",{className:"glass-card px-4 py-2 rounded-full flex items-center gap-2",children:[e.jsx(fe,{className:"w-4 h-4 text-primary"}),e.jsxs("span",{className:"text-sm",children:["Response: ",s?`${w} ms`:"Not Connected"]})]}),e.jsxs(E,{onClick:I,disabled:x,variant:"outline",size:"sm",className:"glass-card",children:[e.jsx(xe,{className:`w-4 h-4 mr-2 ${x?"animate-spin":""}`}),"Reconnect"]}),e.jsx(E,{size:"icon",onClick:ie,className:`rounded-full glass-card relative ${L?"bg-primary/20 text-primary animate-pulse ring-2 ring-primary/40":"text-foreground"}`,children:e.jsx(ye,{className:"w-5 h-5"})})]}),e.jsxs(ge,{defaultValue:"control",children:[e.jsxs(be,{className:"grid w-full max-w-md mx-auto grid-cols-2",children:[e.jsx(U,{value:"control",children:"Kontrol"}),e.jsxs(U,{value:"history",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Riwayat"]})]}),e.jsx(Z,{value:"control",children:e.jsx("div",{className:"space-y-8",children:Object.entries(j).map(([t,n])=>{const o=t,r=g[o],d=r.filter(Boolean).length;return e.jsxs(z,{className:"glass-card",children:[e.jsx(K,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs(F,{className:"flex items-center gap-2 text-2xl mb-2",children:[e.jsx("div",{className:`bg-gradient-to-br ${n.gradient} p-2 rounded-lg`,children:e.jsx(n.icon,{className:"w-6 h-6"})}),n.name]}),e.jsx(O,{children:n.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),e.jsxs("p",{className:"text-lg font-bold text-primary",children:[d,"/",r.length," Aktif"]})]})]})}),e.jsx(G,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:r.map((c,u)=>e.jsxs("div",{className:`glass-card p-4 rounded-lg transition-all ${c?"border-primary/50 shadow-[0_0_15px_rgba(74,222,128,0.2)]":"border-border/50"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-semibold text-sm",children:["#",u+1]}),e.jsx(ne,{checked:c,onCheckedChange:()=>P(o,u),className:"data-[state=checked]:bg-primary"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:c?"Aktif":"Nonaktif"})]},u))})})]},t)})})}),e.jsx(Z,{value:"history",children:e.jsxs(z,{className:"glass-card",children:[e.jsxs(K,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5"}),"Riwayat Kontrol"]}),e.jsx(O,{children:"20 aktivitas terakhir"})]}),e.jsx(G,{children:e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:C.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Belum ada riwayat kontrol"}):C.slice().reverse().map((t,n)=>e.jsxs("div",{className:"glass-card p-4 rounded-lg flex justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:t.device}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(t.timestamp).toLocaleString("id-ID")})]}),e.jsx("span",{className:`font-semibold ${t.state?"text-primary":"text-muted-foreground"}`,children:t.action})]},n))})})]})})]})]}),e.jsx("footer",{className:"border-t border-border bg-background/60 backdrop-blur-md",children:e.jsxs("div",{className:"container mx-auto px-4 py-6 flex flex-col md:flex-row justify-between items-center text-sm text-muted-foreground gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:`w-4 h-4 ${s?"text-green-500 animate-pulse":"text-red-500"}`}),e.jsxs("span",{children:["Firebase:"," ",e.jsx("strong",{className:s?"text-green-500":"text-red-500",children:s?"Connected":"Disconnected"})]})]}),e.jsxs("div",{children:["Response Time:"," ",e.jsx("strong",{className:"text-primary",children:s?`${w} ms`:"N/A"})]}),e.jsxs("div",{children:["Last Connected:"," ",e.jsx("strong",{className:"text-foreground",children:k})]})]})})]})};export{De as default};
